{"remainingRequest":"D:\\Projects\\Wyy\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Projects\\Wyy\\src\\components\\Playbar.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\Projects\\Wyy\\src\\components\\Playbar.vue","mtime":1676809610207},{"path":"D:\\Projects\\Wyy\\node_modules\\css-loader\\index.js","mtime":1653963796432},{"path":"D:\\Projects\\Wyy\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1653963801908},{"path":"D:\\Projects\\Wyy\\node_modules\\postcss-loader\\src\\index.js","mtime":1653963802495},{"path":"D:\\Projects\\Wyy\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1653963798725},{"path":"D:\\Projects\\Wyy\\node_modules\\vue-loader\\lib\\index.js","mtime":1653963801905}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    .playbar{\n\t\tposition: sticky;\n\t\tbottom: 0;\n        display: flex;\n        width: 100%;\n        height: 50px;\n        padding: 5px 10px;\n        background-color: rgba(222,222,222,.4);\n    }\n    .playbar .cover{\n        width: 40px;\n        height: 40px;\n        border-radius: 4px;\n        overflow: hidden;\n        margin-right: 10px;\n    }\n    .playbar .info p:last-child{\n        font-size: 12px;\n        color: #333;\n    }\n    .playbar .info p span::after{\n        content: ' / ';\n        color: #000;\n    }\n    .playbar .info p span:last-child::after{\n        content: '';\n    }\n    .playbar .openw{\n        margin-left: auto;\n    }\n",{"version":3,"sources":["Playbar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Playbar.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div class=\"playbar\" @click=\"playFun(song.id)\">\r\n        <audio id=\"audio\"\r\n            autoplay\r\n            @timeupdate=\"durationUpdate\" \r\n            @ended=\"playend('next')\" />\r\n        <div class=\"cover\">\r\n            <img :src=\"song.al.picUrl\" >\r\n        </div>\r\n        <div class=\"info\">\r\n            <p>{{song.name}}</p>\r\n            <p><span v-for=\"item in song.ar\">{{item.name}}</span></p>\r\n        </div>\r\n        <div class=\"openw\" @click.stop=\"audioPlay(song.id)\">\r\n            <openBtn :isBtn='$parent.play'></openBtn>\r\n        </div>\r\n    </div>\n</template>\n\n<script>\r\n    import Bus from '../Bus.js'\r\n    import openBtn from '../icons/openBtn.vue'\r\n    \r\n    export default{\r\n        name:'Playbar',\r\n        props:['playlist','play'],\r\n        components:{\r\n            openBtn\r\n        },\r\n        data(){\r\n          return{\r\n              song:{\r\n                  al:''\r\n              },\r\n              index:0\r\n          }  \r\n        },\r\n        methods:{\r\n            durationUpdate(){//音乐播放触发\r\n                if(this.$route.path != \"/play\") return false;\r\n                this.$emit('save')\r\n            },\r\n            playFun(id){//点击bar触发\r\n                this.$router.push(\"/play\")\r\n            },\r\n            audioPlay(id){\r\n               let paused = this.$parent.audio.paused;\r\n               if(paused){\r\n                   localStorage.playsongID = id;\r\n                   this.$parent.audio.play();\r\n               }else{\r\n                   this.$parent.audio.pause();\r\n               }\r\n               this.$parent.play = paused;\r\n             },//播放完成触发\r\n            playend(state){\r\n                let playlist = this.$parent.playlist;\r\n                let index = playlist[0].index;\r\n                index++;\r\n                if(index == playlist.length){\r\n                    index == 0;\r\n                }\r\n                playlist[0].index = index;\r\n                const main = this;\r\n                this.user = JSON.parse(localStorage.user);\r\n                this.axios.get(this.ApiURl+'/song/detail',{\r\n                    params:{\r\n                        ids:playlist[index].id,\r\n                        cookie:this.user.cookie\r\n                    }\r\n                }).then(function(res){\r\n                    main.song = res.data.songs[0];\r\n                    Bus.$emit('song',main.song);\r\n                    \r\n                    main.axios.get(main.ApiURl+'/song/url',{\r\n                        params:{\r\n                            id:playlist[index].id, \r\n                            cookie:main.user.cookie\r\n                        }\r\n                    }).then(function(res){\r\n                        window.paused = playlist[index].id;\r\n                        main.$parent.play = true;\r\n                        main.$parent.audio.src = res.data.data[0].url;\r\n                        localStorage.setItem(\"played\",JSON.stringify(main.song));\r\n                    })\r\n                })\r\n            }\r\n        },\r\n        mounted() {\r\n            Bus.$on('song',(song) => {\r\n                this.song = song;\r\n            })\r\n            this.$parent.audio = document.querySelector(\"#audio\");\r\n\t\t\tconsole.log(this.$parent.audio)\r\n            let played = localStorage.played;\r\n            let user = localStorage.user;\r\n            if(!played || !user) return false;\r\n            \r\n            played = JSON.parse(played);\r\n            user = JSON.parse(user);\r\n            this.song = played;\r\n            this.song.play = false;\r\n            const main = this;\r\n            this.axios.get(this.ApiURl+'/song/url',{\r\n                params:{\r\n                    id:played.id,\r\n                    cookie:user.cookie\r\n                }\r\n            }).then(function(res) {\r\n                main.$parent.audio.src = res.data.data[0].url;\r\n                main.$parent.audio.pause();\r\n            })\r\n        },\r\n        watch:{\r\n            play:function (play){\r\n                \r\n            }\r\n        }\r\n    }\n</script>\n\n<style>\r\n    .playbar{\r\n\t\tposition: sticky;\r\n\t\tbottom: 0;\r\n        display: flex;\r\n        width: 100%;\r\n        height: 50px;\r\n        padding: 5px 10px;\r\n        background-color: rgba(222,222,222,.4);\r\n    }\r\n    .playbar .cover{\r\n        width: 40px;\r\n        height: 40px;\r\n        border-radius: 4px;\r\n        overflow: hidden;\r\n        margin-right: 10px;\r\n    }\r\n    .playbar .info p:last-child{\r\n        font-size: 12px;\r\n        color: #333;\r\n    }\r\n    .playbar .info p span::after{\r\n        content: ' / ';\r\n        color: #000;\r\n    }\r\n    .playbar .info p span:last-child::after{\r\n        content: '';\r\n    }\r\n    .playbar .openw{\r\n        margin-left: auto;\r\n    }\n</style>\n"]}]}